<?xml version="1.0" ?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

    <xacro:arg name="use_collision_meshes" default="true" />

    <xacro:macro name="cobot_arm" params="name prefix parent" >

        <!-- Links -->

        <link name="${parent}"/>
        
        <link name="${prefix}segment1">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                <geometry>
                    <!-- using a DAE mesh to display logos -->
                <mesh filename="package://dual_cobot_model/meshes/visual/segment_01_logo.dae"/>
                </geometry>
                <material name="${prefix}segment1_material">
                    <color rgba="0.89 0.133 0.098 1.0" />
                </material>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                    <geometry>
                        <mesh filename="package://dual_cobot_model/meshes/collision/segment01_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.156"/>
                    <geometry>
                        <cylinder radius="0.09" length="0.312"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="7.3" />
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.156" />
                <inertia ixx="0.0697588" iyy="0.0697588" izz="0.0210824" ixy="0.0" ixz="0.0" iyz="0.0" />
            </inertial>
        </link>
        <link name="${prefix}segment2">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/segment02_visual.stl"/>
                </geometry>
                <material name="${prefix}segment2_material">
                    <color rgba="0 0.6 1.0 1.0" />
                </material>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                    <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/collision/segment02_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.09"/>
                    <geometry>
                        <box size="0.155 0.238 0.186"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="5.0" />
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.119" />
                <inertia ixx="0.03441292" iyy="0.02442542" izz="0.03361208" ixy="0.0" ixz="0.0" iyz="0.0" />
            </inertial>
        </link>
        <link name="${prefix}segment3">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/segment03_visual.stl"/>
                </geometry>
                <material name="${prefix}segment3_material">
                <color rgba="0.835 0.059 0.235 1.0" />
                </material>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                    <geometry>
                        <mesh filename="package://dual_cobot_model/meshes/collision/segment03_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="1.5708 0.0 0.0" xyz="0.0 0.126 0.06"/>
                    <geometry>
                        <cylinder radius="0.06" length="0.372"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="2.5" />
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.126 0.06" />
                <inertia ixx="0.06515833" ixy="0.0" ixz="0.0" iyy="0.01316667" iyz="-0.0189" izz="0.05607417" />
            </inertial>
        </link>
        <link name="${prefix}segment4">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/segment04_visual.stl"/>
                </geometry>
                <material name="${prefix}segment4_material">
                    <color rgba="0.004 0.176 0.353 1.0" />
                </material>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                    <geometry>
                        <mesh filename="package://dual_cobot_model/meshes/collision/segment04_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.1125"/>
                    <geometry>
                        <cylinder radius="0.07" length="0.225"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="3.4" />
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.112" />
                <inertia ixx="0.01850875" ixy="0.0" ixz="0.0" iyy="0.01850875" iyz="0.0" izz="0.00833" />
            </inertial>
        </link>
        <link name="${prefix}segment5">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/segment05_visual.stl"/> 
                </geometry>
                <material name="${prefix}segment5_material">
                    <color rgba="0 0.6 1.0 1.0" />
                </material>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                    <geometry>
                        <mesh filename="package://dual_cobot_model/meshes/collision/segment05_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.1"/>
                    <geometry>
                        <cylinder radius="0.07" length="0.23"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="3.0" />
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.071" />
                <inertia ixx="0.02173675" iyy="0.02173675" izz="0.0075615" ixy="0.0" ixz="0.0" iyz="0.0" />
            </inertial>
        </link>
        <link name="${prefix}segment6">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/segment06_visual.stl"/>
                </geometry>
                <material name="${prefix}segment6_material">
                    <color rgba="0.835 0.059 0.235 1.0" />
                </material>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
                    <geometry>
                        <mesh filename="package://dual_cobot_model/meshes/collision/segment06_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 1.5708 0.0" xyz="-0.12 0.0 -0.04"/>
                    <geometry>
                        <cylinder length="0.15" radius="0.04"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="1.5" />
                <origin rpy="0.0 0.0 0.0" xyz="-0.05 0.0 0.0" />
                <inertia ixx="0.00319363" iyy="0.00513113" izz="0.0061625" ixy="0.0" ixz="0.0" iyz="0.0" />
            </inertial>
        </link>
        <link name="${prefix}segment7">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
                <material name="Aterul">
                    <color rgba="1.0 1.0 1.0 1.0"/>
                </material>
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/segment07_visual.stl" />
                </geometry>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
                    <geometry>
                        <mesh filename="package://dual_cobot_model/meshes/collision/segment07_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="-0.785398 0.0 0.0" xyz="0.0 0.1 0.05"/>
                    <geometry>
                        <box size="0.124 0.135 0.14"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="4.0"/>
                <!-- tilt the inertia tensor by 45 deg to match the actual mesh
                    => same tilt is applied in the tool_base link -->
                <origin rpy="0.785398 0.0 0.0" xyz="0.0 0.09 0.04"/>
            <inertia ixx="0.01533367" iyy="0.02185067" izz="0.02693367" ixy="0.0" ixz="0.0" iyz="0.0" />
            </inertial>
        </link>
        <link name="${prefix}finger1">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
                <material name="silver">
                    <color rgba="0.629 0.629 0.625 1.0" />
                </material>
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/finger01_visual.stl"/>
                </geometry>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
                    <geometry>
                            <mesh filename="package://dual_cobot_model/meshes/collision/finger01_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <!-- tilt geometric object by 15 deg to match real gripper -->
                    <origin rpy="0.0 -0.261799 0.0" xyz="0.046 0.0 0.056"/>
                    <geometry>
                        <cylinder length="0.10" radius="0.01"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="0.05" />
                <origin rpy="0.0 -0.261799 0.0" xyz="0.046 0.0 0.056"/>
                <inertia ixx="3.46666667e-05" iyy="2.64166667e-05" izz="1.78833333e-05" ixy="0.0" ixz="0.0" iyz="0.0" />
            </inertial>
        </link>
        <link name="${prefix}finger2">
            <visual>
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
                <material name="silver">
                    <color rgba="0.629 0.629 0.625 1.0" />
                </material>
                <geometry>
                    <mesh filename="package://dual_cobot_model/meshes/visual/finger02_visual.stl"/>
                </geometry>
            </visual>
            <collision>
                <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
                    <geometry>
                        <mesh filename="package://dual_cobot_model/meshes/collision/finger02_collision.stl"/>
                    </geometry>
                </xacro:if>
                <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                    <origin rpy="0.0 0.261799 0.0" xyz="-0.046 0.0 0.056"/>
                    <geometry>
                        <cylinder length="0.10" radius="0.01"/>
                    </geometry>
                </xacro:unless>
            </collision>
            <inertial>
                <mass value="0.05" />
                <origin rpy="0.0 0.261799 0.0" xyz="-0.046 0.0 0.056"/>
                <inertia ixx="3.46666667e-05" iyy="2.64166667e-05" izz="1.78833333e-05" ixy="0.0" ixz="0.0" iyz="0.0" />
            </inertial>
        </link>
        <link name="${prefix}vacuum_gripper_up">
        <visual>
        <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        <material name="silver">
            <color rgba="0.629 0.629 0.625 1.0"/>
        </material>
        <geometry>
            <mesh filename="package://dual_cobot_model/meshes/visual/vacuum_visual.stl"/>
        </geometry>
        </visual>
        <collision>
        <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <geometry>
                <mesh filename="package://dual_cobot_model/meshes/collision/vacuum_collision.stl"/>
            </geometry>
        </xacro:if>
        <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.03"/>
            <geometry>
                <cylinder length="0.10" radius="0.01"/>
            </geometry>
        </xacro:unless>
        </collision>
        <inertial>
        <mass value="0.05"/>
        <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.05"/>
        <inertia ixx="2.08333333e-05" ixy="0.0" ixz="0.0" iyy="2.08333333e-05" iyz="0.0" izz="2.08333333e-05"/>
        </inertial>
    </link>
    <link name="${prefix}vacuum_gripper_down">
        <visual>
        <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
        <material name="silver">
            <color rgba="0.629 0.629 0.625 1.0"/>
        </material>
        <geometry>
            <!-- using the same mesh as for the upper vacuum gripper (they look the same in the model) -->
            <mesh filename="package://dual_cobot_model/meshes/visual/vacuum_visual.stl"/>
        </geometry>
        </visual>
        <collision>
            <xacro:if value="${'$(arg use_collision_meshes)' == 'true'}">
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
                <geometry>
                    <!-- using the same mesh as for the upper vacuum gripper (they look the same in the model) -->
                    <mesh filename="package://dual_cobot_model/meshes/collision/vacuum_collision.stl"/>
                </geometry>
            </xacro:if>
        <xacro:unless value="${'$(arg use_collision_meshes)' == 'true'}">
                <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.03"/>
                <geometry>
                    <cylinder length="0.10" radius="0.01"/>
                </geometry>
        </xacro:unless>
        </collision>
        <inertial>
        <mass value="0.05"/>
        <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.05"/>
        <inertia ixx="2.08333333e-05" ixy="0.0" ixz="0.0" iyy="2.08333333e-05" iyz="0.0" izz="2.08333333e-05"/>
        </inertial>
    </link>

        <!-- the virtual links
        We follow the following structure to enable individual TCPs per tool:
        link_0 -> ... -> link_n -> flange -> tool_base
                                                -> gripper_tcp
                                                    -> gripper_tcp_world
                                                        -> gripper_tcp_world_tilted_up
                                                        -> gripper_tcp_world_tilted_down
                                                -> vacuump_up_tcp
                                                -> vacuum_down_tcp

        The additional TCP frames are defined to ease up IK requests (omitting transformations in code):
            * TCP in world frame: all rotations inverted
                => cobot can move to any point in its neutral orientation
            * TCP in world tilted z up: compensates the natural tilt in the physical model, Z+ is up
                => cobot will approach any object with a neutral orientation from above
            * TCP in world tilted z down: same as previous but Z+ pointing down
                => cobot will approach objects from above that have an inverted orientation
        -->

        <link name="${prefix}flange"/>
        <link name="${prefix}tool_base"/>

        <link name="${prefix}gripper_tcp"/>
        <link name="${prefix}gripper_tcp_world"/>
        <link name="${prefix}gripper_tcp_world_tilted_up"/>
        <link name="${prefix}gripper_tcp_world_tilted_down"/>
        <link name="${prefix}vacuum_up_tcp"/>
        <link name="${prefix}vacuum_up_tcp_world"/>
        <link name="${prefix}vacuum_up_tcp_world_tilted_up"/>
        <link name="${prefix}vacuum_up_tcp_world_tilted_down"/>
        <link name="${prefix}vacuum_down_tcp"/>
        <link name="${prefix}vacuum_down_tcp_world"/>
        <link name="${prefix}vacuum_down_tcp_world_tilted_up"/>
        <link name="${prefix}vacuum_down_tcp_world_tilted_down"/>

        <!-- Joints -->
        <joint name="${prefix}JFix_Base" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
            <parent link="${parent}" />
            <child link="${prefix}segment1" />
        </joint>

        <joint name="${prefix}joint_1" type="revolute">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}segment1" />
            <child link="${prefix}segment2" />
            <axis xyz="0 0 1" />
            <!-- <limit effort="200.0" velocity="3.14159" lower="-2.37365" upper="2.37365" /> -->
            <limit effort="200.0" velocity="3.14159" lower="-3.14" upper="3.14" />
            <dynamics damping="0.0" friction="0.0" />
        </joint>
        <joint name="${prefix}joint_2" type="revolute">
            <origin rpy="1.5708 0.0 0.0" xyz="0.0 -0.111 0.118"/>
            <parent link="${prefix}segment2" />
            <child link="${prefix}segment3" />
            <axis xyz="0 0 1" />
            <!-- <limit effort="150.0" velocity="3.14159" lower="-2.26893" upper="0.785398" /> -->
            <limit effort="200.0" velocity="3.14159" lower="-3.14" upper="3.14" />
            <dynamics damping="0.0" friction="0.0" />
        </joint>
        <joint name="${prefix}joint_3" type="revolute">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.254 0.06"/>
            <parent link="${prefix}segment3" />
            <child link="${prefix}segment4" />
            <axis xyz="0 0 1" />
            <!-- <limit effort="100.0" velocity="3.14159" lower="-0.785398" upper="2.26893" /> -->
            <limit effort="200.0" velocity="3.14159" lower="-3.14" upper="3.14" />
            <dynamics damping="0.0" friction="0.0" />
        </joint>
        <joint name="${prefix}joint_4" type="revolute">
            <origin rpy="0.0 1.5708 0.0" xyz="0.062 0.0 -0.168"/>
            <parent link="${prefix}segment4" />
            <child link="${prefix}segment5" />
            <axis xyz="0 0 1" />
        <!--  <limit effort="50.0" velocity="3.14159" lower="-1.5708" upper="1.5708" /> -->
        <limit effort="200.0" velocity="3.14159" lower="-3.14" upper="3.14" />
            <dynamics damping="0.0" friction="0.0" />
        </joint>
        <joint name="${prefix}joint_5" type="revolute">
            <origin rpy="0.0 1.5708 0.0" xyz="0.042 0.0 0.183"/>
            <parent link="${prefix}segment5" />
            <child link="${prefix}segment6" />
            <axis xyz="0 0 1" />
        <!--  <limit effort="50.0" velocity="3.14159" lower="-1.5708" upper="1.5708" /> -->
        <limit effort="200.0" velocity="3.14159" lower="-3.14" upper="3.14" />
            <dynamics damping="0.0" friction="0.0" />
        </joint>
        <joint name="${prefix}joint_6" type="revolute">
            <origin rpy="0.0 -1.5708 0.0" xyz="-0.156 0.0 -0.04"/>
            <parent link="${prefix}segment6"/>
            <child link="${prefix}segment7"/>
            <axis xyz="0 0 1"/>
        <!--  <limit effort="20." lower="-2.37365" upper="2.37365" velocity="3.14159"/> -->
        <limit effort="200.0" velocity="3.14159" lower="-3.14" upper="3.14" />
            <dynamics damping="0.0" friction="0.0"/>
        </joint>
        <joint name="${prefix}flange_fixed" type="fixed">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}segment7"/>
            <child link="${prefix}flange"/>
        </joint>
        <joint name="${prefix}tool_mount" type="fixed">
            <!-- tilt tool base by 45 deg + move coordinate frame -->
            <origin rpy="0.785398 0.0 0.0" xyz="0.0 0.072 0.060"/>
            <parent link="${prefix}flange"/>
            <child link="${prefix}tool_base"/>
        </joint>

        <joint name="${prefix}gripper_tcp_mount" type="fixed">
            <!-- place gripper TCP in between the fingers (z-direction) -->
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.075"/>
            <parent link="${prefix}tool_base"/>
            <child link="${prefix}gripper_tcp"/>
        </joint>
        <joint name="${prefix}gripper_tcp_world_mount" type="fixed">
            <!-- reverse all previous rotations -->
            <origin rpy="-3.14159 -0.785398 1.5708" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}gripper_tcp"/>
            <child link="${prefix}gripper_tcp_world"/>
        </joint>
        <joint name="${prefix}gripper_tcp_world_tilted_up_mount" type="fixed">
            <!-- tilt gripper tcp in world frame by -45 deg to compensate for natural tilt --> 
            <origin rpy="0.0 -0.785398 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}gripper_tcp_world"/>
            <child link="${prefix}gripper_tcp_world_tilted_up"/>
        </joint>
        <joint name="${prefix}gripper_tcp_world_tilted_down_mount" type="fixed">
            <!-- tilt gripper tcp in world frame by 135 deg to compensate for natural tilt with z-axis looking down --> 
            <origin rpy="0.0 2.35619 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}gripper_tcp_world"/>
            <child link="${prefix}gripper_tcp_world_tilted_down"/>
        </joint>
        <joint name="${prefix}finger1_joint" type="prismatic">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}tool_base" />
            <child link="${prefix}finger1" />
            <axis xyz="-1 0 0" />
            <limit effort="30.0" velocity="0.1" lower="-0.01" upper="0.029" />
        </joint>
        <joint name="${prefix}finger2_joint" type="prismatic">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}tool_base" />
            <child link="${prefix}finger2" />
            <axis xyz="1 0 0" />
            <limit effort="30.0" velocity="0.1" lower="-0.01" upper="0.029" />
            <mimic joint="${prefix}finger1_joint" />
        </joint>

        <joint name="${prefix}vacuum_up_joint" type="prismatic">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.035 0.0"/>
            <parent link="${prefix}tool_base"/>
            <child link="${prefix}vacuum_gripper_up"/>
            <axis xyz="0 0 1"/>
            <limit effort="30.0" lower="-0.01" upper="0.055" velocity="0.1"/>
        </joint>
        <joint name="${prefix}vacuum_up_tcp_mount" type="fixed">
            <!-- place TCP at the end of the tool (z-direction) -->
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.07"/>
            <parent link="${prefix}vacuum_gripper_up"/>
            <child link="${prefix}vacuum_up_tcp"/>
        </joint>
        <joint name="${prefix}vacuum_up_tcp_world_mount" type="fixed">
            <!-- reverse all previous rotations -->
            <origin rpy="-3.14159 -0.785398 1.5708" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}vacuum_up_tcp"/>
            <child link="${prefix}vacuum_up_tcp_world"/>
        </joint>
        <joint name="${prefix}vacuum_up_tcp_world_tilted_up_mount" type="fixed">
            <!-- tilt gripper tcp in world frame by -45 deg to compensate for natural tilt --> 
            <origin rpy="0.0 -0.785398 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}vacuum_up_tcp_world"/>
            <child link="${prefix}vacuum_up_tcp_world_tilted_up"/>
        </joint>
        <joint name="${prefix}vacuum_up_tcp_world_tilted_down_mount" type="fixed">
            <!-- tilt gripper tcp in world frame by 135 deg to compensate for natural tilt with z-axis looking down --> 
            <origin rpy="0.0 2.35619 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}vacuum_up_tcp_world"/>
            <child link="${prefix}vacuum_up_tcp_world_tilted_down"/>
        </joint>
        <joint name="${prefix}vacuum_down_joint" type="prismatic">
            <origin rpy="0.0 0.0 0.0" xyz="0.0 -0.035 0.0"/>
            <parent link="${prefix}tool_base"/>
            <child link="${prefix}vacuum_gripper_down"/>
            <axis xyz="0 0 1"/>
            <limit effort="30.0" lower="-0.01" upper="0.055" velocity="0.1"/>
        </joint>
        <joint name="${prefix}vacuum_down_tcp_mount" type="fixed">
            <!-- place TCP at the end of the tool (z-direction) -->
            <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.07"/>
            <parent link="${prefix}vacuum_gripper_down"/>
            <child link="${prefix}vacuum_down_tcp"/>
        </joint>
        <joint name="${prefix}vacuum_down_tcp_world_mount" type="fixed">
            <!-- reverse all previous rotations -->
            <origin rpy="-3.14159 -0.785398 1.5708" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}vacuum_down_tcp"/>
            <child link="${prefix}vacuum_down_tcp_world"/>
        </joint>
        <joint name="${prefix}vacuum_down_tcp_world_tilted_up_mount" type="fixed">
            <!-- tilt gripper tcp in world frame by -45 deg to compensate for natural tilt --> 
            <origin rpy="0.0 -0.785398 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}vacuum_down_tcp_world"/>
            <child link="${prefix}vacuum_down_tcp_world_tilted_up"/>
        </joint>
        <joint name="${prefix}vacuum_down_tcp_world_tilted_down_mount" type="fixed">
            <!-- tilt gripper tcp in world frame by 135 deg to compensate for natural tilt with z-axis looking down --> 
            <origin rpy="0.0 2.35619 0.0" xyz="0.0 0.0 0.0"/>
            <parent link="${prefix}vacuum_down_tcp_world"/>
            <child link="${prefix}vacuum_down_tcp_world_tilted_down"/>
        </joint>

        <!-- include ROS2 controls -->
        <xacro:include filename="robot_ros2_controls_macro.xacro" />
        <xacro:robot_ros2_controls name="${name}" prefix="${prefix}"/>

    </xacro:macro>
</robot>